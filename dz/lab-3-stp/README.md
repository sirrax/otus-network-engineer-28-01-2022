
## Часть 1: Создание сети и настройка основных параметров устройств

Базовая топология

![](/picture/lab-3-spt/topology.jpg)

Базовая настройка коммутаторов:

[Базовая настройка](conspect)

Проверяем работоспособность собраной топологии:


![](/picture/lab-3-spt/ping-S1-S2.jpg)

![](/picture/lab-3-spt/ping-S1-S3.jpg)

![](/picture/lab-3-spt/ping-S2-S3.jpg)

Отключаем все порты, и настраиваем транки:

![](/picture/lab-3-spt/switchport-trunk.jpg)

## Часть 2: Определение корневого моста

Включаем порты e0/0, e0/2 проверяем spt

![](/picture/lab-3-spt/spt-e0_1-e0_3-shutdown.jpg)

![](/picture/lab-3-spt/spt-S1.jpg)

![](/picture/lab-3-spt/spt-S2.jpg)

![](/picture/lab-3-spt/spt-S3.jpg)


Коммутатор S1 в данной конфигурации выбрался Root bridge так как он имеет наименьший Bridge ID (по причине наименьшего MAC адреса из трех коммутаторов).

Designated Port были назначены на:
* Все его активные порты коммутатора S1 e0/0, e0/1
* Потры e0/2 коммутатора S2 и e0/0 коммутатора S3 так как они смотрят на  Root bridge
* Порт e0/0 коммутатора S2 

Alternate Port был назначен порту e0/2 коммутатора S3 по причине того что при равной стоимости путей портов e0/0 - S2 и e0/2 - S3, Bridge ID коммутатора S2 меньше чем Bridge ID у S3.



## Часть 3: Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов.


У коммутатора S3 заблокирован порт e0/2. Помимо заблокированного порта, единственным активным портом на этом коммутаторе является порт e0/0, выделенный в качестве порта Root. Уменьшим его стоимость.

![](/picture/lab-3-spt/S3-cost-port-spt.jpg)

После этого на не корневых коммутаторах поменялось назначение портов так как стоимость путей стала разная и не смотря на то что Bridge ID у коммутатора S2 меньше чем у S3, порт e0/0 - S2 стал Alternate так как у него Cost выше чем у e0/0 - S3.


![](/picture/lab-3-spt/spt-S2_2.jpg)

![](/picture/lab-3-spt/spt-S3_2.jpg)

Отменим изменение стоимость порта.

![](/picture/lab-3-spt/S3-no-cost-port-spt.jpg)


## Часть 4:	Наблюдение за процессом выбора протоколом STP порта, исходя из приоритета портов.

Если стоимости портов равны, процесс сравнивает BID. Если BID равны, для определения корневого моста используются приоритеты портов. Значение приоритета по умолчанию — 128. STP объединяет приоритет порта с номером порта, чтобы разорвать связи. Наиболее низкие значения являются предпочтительными.

Включаем порты F0/1 и F0/3 на всех коммутаторах. Проверяем SPT.

![](/picture/lab-3-spt/spt-S1-all-ports.jpg)

![](/picture/lab-3-spt/spt-S2-all-ports.jpg)

![](/picture/lab-3-spt/spt-S3-all-ports.jpg)


![](/picture/lab-3-spt/spt-all.jpg)

Порт e0/1 коммутатора S2 и порт e0/0 - S3 стали Root, так как имеют наименьший номер порта относительно соседних портов смотрящих на Root коммутатор.

	Иерархия в какой STP принимает решение:

    1. Сравнивается BridgeID коммутаторов.
    2. Сравиниваются стоимости пути портов.
    3. Сравниваются номера портов.














































